---
title: "구글에-접속하면-컴퓨터에서-일어나는-일"
date: 2026-01-28
draft: false
tags: ["tech", "network"]
categories: ["tech"]
description: "구글에 접속하면 컴퓨터에서 일어나는 일에 대한 설명글"
keywords: ["구글", "인터넷접속", "사이트접속"]
---

[youtube link](https://www.youtube.com/watch?v=3gXy1MnJXv0)

## 서론

새 컴퓨터를 처음 네트워크에 연결한 뒤 웹 브라우저에 `google.com`을 입력해 접속하는 과정은, 겉으로는 “웹 요청을 보내고 응답을 받는” 단순한 절차처럼 보인다. 그러나 실제로는 물리 계층의 링크 협상부터 주소 할당, 로컬 네트워크 내 식별, 이름 해석(name resolution), 라우팅 경로 결정, 전송 계층 연결 수립을 거쳐서야 비로소 애플리케이션 계층의 HTTP 트래픽이 시작된다. 이 과정의 상당 부분은 캐시(cache)로 인해 반복 시에는 보이지 않지만, “새 컴퓨터·새 네트워크” 조건에서는 거의 모든 단계가 최초 실행으로 발생한다. 

본 문서는 완전히 초기화된 단말이 네트워크에 편입되어 도메인 기반 URL에 접속하기까지의 통신 절차를, 계층별 기능과 캐시/테이블의 형성이라는 관점에서 주제 중심으로 정리한다. 

## 쟁점 및 배경

### 1) “HTTP가 마지막에 온다”는 구조적 사실

브라우저가 생성하는 HTTP 요청은 전체 절차의 출발점이 아니라 종착점에 가깝다. 도메인 이름을 IP 주소로 바꾸는 과정(DNS), IP 패킷을 로컬 링크에서 전달하기 위한 MAC 주소 결정(ARP), 외부 네트워크로 나가기 위한 기본 게이트웨이 설정(DHCP 제공 정보), 그리고 신뢰성 있는 전송을 위한 TCP 연결 수립이 선행되어야 한다. 

### 2) 자동화된 “초기 편입”의 핵심: 주소·경로·해석 정보의 획득

현대 단말은 사람이 IP를 수동 설정하지 않아도 네트워크에 붙는 즉시 자동으로 필요한 정보를 확보한다. 이 자동화의 중심이 DHCP(Dynamic Host Configuration Protocol)이며, 단말이 통신을 시작하기 위한 최소 요건(자신의 IP, 서브넷 마스크, 기본 게이트웨이, DNS 서버)을 제공한다. 

### 3) 최초 접속이 ‘느리고 복잡해 보이는’ 이유: 캐시가 아직 없기 때문이다

로컬 네트워크에서의 주소 대응(ARP 캐시), 이름 해석 결과(DNS 캐시), 스위치의 MAC 주소 테이블 같은 학습 상태는 시간이 지나며 누적된다. 새 환경에서는 이 학습이 처음부터 수행되어야 하므로, “접속 이전 트래픽”이 상대적으로 많이 발생한다. 

## 본론

## 물리 계층과 링크 협상: 연결 직후 가장 먼저 일어나는 일

단말을 이더넷에 연결하면, 가장 먼저 물리 계층(Layer 1)에서 링크 속도(예: 1Gbps/100Mbps 등)와 듀플렉스(전이중/반이중)가 자동 협상된다. 이는 IP나 DNS와 무관하게 “링크를 어떤 조건으로 사용할 것인가”를 정하는 절차이며, 연결 직후 즉시 수행된다. 

## DHCP로 시작되는 주소 할당: 단말이 “자기 주소”를 얻는 과정

### DHCP 4단계 절차와 브로드캐스트의 역할

단말은 초기에는 IP 주소가 없으므로, 먼저 DHCP 서버를 찾아야 한다. 이때 단말은 DHCP Discover 메시지를 전송하는데, 목적지 MAC 주소를 브로드캐스트(모든 장치에게 전달되는 특수 주소)로 설정한다. 스위치는 목적지 MAC이 브로드캐스트임을 보고, 수신 포트를 제외한 모든 포트로 프레임을 플러딩(flooding)한다. DHCP 서버를 제외한 다른 장치들은 이를 읽더라도 자신에게 해당하지 않으면 폐기한다. 

DHCP 서버는 IP 풀(pool)에서 임대할 주소를 선택하여 DHCP Offer를 반환한다. 이때는 대상 단말의 MAC을 알고 있으므로 유니캐스트(unicast)로 회신할 수 있으며, 스위치는 MAC 테이블 조회를 통해 해당 단말이 연결된 포트로만 프레임을 포워딩(forwarding)한다. 

절차는 Discover–Offer–Request–Acknowledgement의 4단계(DORA)로 완결되며, Request/ACK는 다수 DHCP 서버가 존재할 수 있는 환경에서 “어느 제안을 선택했는지”를 확정하는 의미를 갖는다. 

### DHCP가 제공하는 4가지 핵심 정보

DHCP 승인 이후 단말은 통신에 필요한 기본 정보를 일괄 획득한다.

* **단말 IP 주소**(예: 192.168.1.10)
* **서브넷 마스크**(예: 255.255.255.0): “내 네트워크” 범위의 판별 규칙
* **기본 게이트웨이(Default Gateway)**(예: 192.168.1.1): 외부망으로 나갈 첫 홉
* **DNS 서버 주소**(예: 192.168.1.200): 도메인 이름을 IP로 해석할 서버 

이 4가지는 이후의 DNS, 라우팅, TCP 연결 수립에 직접 사용되는 전제 조건이다. 

## 스위치의 MAC 주소 테이블: 로컬 전달이 “학습”되는 방식

스위치는 프레임을 받을 때마다 **출발지 MAC 주소**를 읽어 “이 MAC은 이 포트에 있다”는 매핑을 MAC 주소 테이블에 학습한다. 최초 Discover가 도착하면 스위치는 단말의 MAC(예시로 ‘AAAA…’)을 수신 포트에 연결해 기록한다. DHCP 서버가 Offer를 보낼 때는 서버의 MAC(예시 ‘BBBB…’)도 동일하게 학습된다. 이 학습이 쌓이면, 이후 유니캐스트 트래픽은 플러딩이 아니라 테이블 기반 포워딩으로 처리되어 불필요한 확산이 줄어든다. 

## google.com 입력 이후 1단계: DNS 캐시 확인과 “이름 해석”의 필요

브라우저에 `google.com`을 입력하면 단말은 우선 로컬 DNS 캐시에 해당 도메인의 해석 결과가 있는지 확인한다. 새 컴퓨터 조건에서는 캐시가 비어 있으므로, DHCP로 받은 DNS 서버로 질의(DNS Query)를 보내야 한다. 그러나 DNS 서버의 IP는 알아도, 로컬 링크에서 프레임을 보낼 때 필요한 **DNS 서버의 MAC 주소**는 아직 모를 수 있다. 이 공백을 메우는 절차가 ARP(Address Resolution Protocol)이다. 

## ARP로 시작되는 로컬 주소 해석: IP를 MAC으로 바꾸는 과정

### ARP 요청/응답과 ARP 캐시의 형성

단말은 “IP 192.168.1.200을 가진 장치의 MAC은 무엇인가”를 묻기 위해 ARP Request를 브로드캐스트로 전송한다(목적지 MAC은 브로드캐스트). 동일 네트워크 상의 장치들은 ARP 패킷의 목적지 IP를 확인해, 자신의 IP가 아니면 폐기한다. DNS 서버만이 “그 IP는 내 것이다”라고 판단하여 ARP Reply로 자신의 MAC(예시 ‘CCCC…’)을 단말에 유니캐스트로 알려준다. 

단말은 이 결과를 **ARP 캐시(IP→MAC 매핑)**에 저장한다. 이후 같은 DNS 서버로 통신할 때는 ARP를 다시 수행하지 않고 캐시를 재사용할 수 있다. 

## DNS 질의/응답과 DNS 캐시: 도메인을 IP로 바꾸는 결정적 단계

ARP로 DNS 서버 MAC을 확보하면, 단말은 DNS Query를 보내 `google.com`의 IP를 질의한다. DNS 서버가 응답(DNS Response)으로 특정 IP(예시로 1.2.3.4)를 제공하면, 단말은 이를 **DNS 캐시(도메인→IP 매핑)**에 저장한다. 이후 같은 도메인 접속은 이 캐시를 통해 더 빠르게 진행될 수 있다. 

## 외부망으로 나가기 위한 판단: 서브넷 마스크와 기본 게이트웨이

단말은 이제 목적지 IP를 얻었지만, 그 IP가 “내 네트워크 내부”인지 “외부 인터넷”인지 판단해야 한다. 이 판단은 **단말 IP + 서브넷 마스크 + 목적지 IP**의 조합으로 이뤄진다. 예시 구조에서는 192.168.1.* 대역이 로컬이며, 목적지 IP(예시 1.2.3.4)는 로컬이 아니므로 외부로 나가야 한다. 그러면 단말은 목적지로 직접 보내지 않고, 먼저 **기본 게이트웨이(라우터)**로 프레임을 보낸다. 

이때도 동일한 문제가 반복된다. 게이트웨이의 IP는 DHCP로 받았지만, 게이트웨이의 MAC 주소는 모를 수 있으므로 ARP를 한 번 더 수행하여 게이트웨이 MAC(예시 ‘DDDD…’)을 ARP 캐시에 추가한다. 

## TCP 연결 수립: HTTP 이전의 전송 계층 준비

웹 트래픽은 보통 TCP 위에서 동작하므로, 실제 HTTP 요청 전에 TCP 3-way handshake(SYN → SYN-ACK → ACK)가 수행된다. 단말에서 첫 SYN 패킷이 로컬 네트워크를 떠날 때, 프레임의 목적지 MAC은 “구글 서버”가 아니라 “기본 게이트웨이(첫 홉 라우터)”의 MAC이 된다. 반면 IP 헤더의 목적지 IP는 구글 서버 IP로 유지된다. 

이후 패킷이 라우터를 거쳐 인터넷을 통과할 때, **MAC 주소는 홉마다 교체**되는 반면, **IP 주소(목적지/출발지)는 종단 간 식별을 위해 대체로 유지**된다는 점이 강조된다(특정 상황에서는 NAT가 개입할 수 있으나, 여기서는 상세를 다루지 않는다). 

## 최종 단계: HTTP 요청/응답과 렌더링

TCP 연결이 성립하면 비로소 HTTP 요청이 전송되고, 서버는 HTML, JavaScript, CSS 등 페이지 렌더링에 필요한 리소스를 응답으로 돌려준다. 브라우저는 이 응답을 기반으로 페이지를 구성·표시한다. 이로써 사용자가 체감하는 “google.com 접속”이 완료된다. 

## 결론

신규 단말의 첫 웹 접속은 링크 협상, 주소 임대, 로컬 전달 학습, 이름 해석, 전송 계층 연결 수립이 연쇄적으로 결합된 결과로 성립한다. 특히 로컬 네트워크에서는 브로드캐스트를 통한 발견과 ARP 기반의 주소 해석이 초기 편입의 핵심이며, 스위치·단말·서버는 각자의 테이블과 캐시를 축적해 이후 통신의 비용을 지속적으로 절감한다. 

동일한 절차는 특정 사이트에 국한되지 않고, 도메인 기반 접속이라는 일반적 사용 행위 전반에 적용된다. 따라서 성능과 장애의 진단은 “HTTP가 되느냐”가 아니라, 어느 계층(주소/이름/경로/연결)에서 선행 조건이 충족되지 않았는지를 구분하는 관점에서 수행되어야 한다. 

## 주요 주장 및 요지

* 새 컴퓨터의 `google.com` 접속에서 HTTP 요청/응답은 최후 단계이며, 그 전에 다수의 선행 트래픽이 발생한다. 
* 연결 직후 물리 계층에서 링크 속도와 듀플렉스가 자동 협상된다. 
* 단말은 IP가 없으므로 DHCP를 통해 주소를 임대받으며, 절차는 Discover–Offer–Request–Acknowledgement(DORA)로 구성된다. 
* DHCP는 단말 IP, 서브넷 마스크, 기본 게이트웨이, DNS 서버를 함께 제공하여 이후 단계의 전제 조건을 만든다. 
* 스위치는 출발지 MAC을 관찰해 MAC 주소 테이블을 학습하고, 브로드캐스트는 플러딩, 유니캐스트는 포워딩으로 처리한다. 
* DNS 질의 이전에 ARP가 선행될 수 있으며, ARP는 IP를 MAC으로 해석해 ARP 캐시를 형성한다. 
* DNS 응답은 도메인(`google.com`)을 IP로 해석하며, 결과는 DNS 캐시에 저장되어 재사용된다. 
* 목적지 IP가 로컬 서브넷 밖이면 단말은 기본 게이트웨이로 보낸 뒤 라우팅을 통해 외부망으로 나간다. 
* 외부로 나가는 첫 홉에서도 게이트웨이 MAC을 얻기 위한 ARP가 추가로 수행될 수 있다. 
* 웹 트래픽은 TCP 위에서 동작하므로 HTTP 이전에 TCP 3-way handshake가 수행된다. 
* 인터넷 구간에서 MAC 주소는 홉마다 바뀌는 반면, IP 주소는 종단 간 통신 식별을 위해 대체로 유지된다. 
* TCP 연결 수립 이후에야 HTTP 요청이 전송되고, 응답 리소스(HTML/JavaScript/CSS)가 도착해 브라우저 렌더링이 가능해진다. 

